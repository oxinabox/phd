\usepackage{amsmath, amssymb, stmaryrd}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

\usepackage{xparse,xstring,etoolbox}
% crossref this against notation section
\renewcommand{\v}[1]{\tilde{#1}} % vector
\newcommand{\s}[1]{\mathcal{#1}} % sequence

%%%%%%%%%
% Indexing/sequence indexing
\newcommand{\seqind}[2]{#1^{(#2)}} % seqence index
\newcommand{\ind}[2]{#1_{\left[ #2 \right]}} % indexed
\newcommand{\disamb}[2]{#1^{\mathrm{(#2)}}} %disambiguated

%% Smart indexing and naming
\newcommand{\ifupper}[3]{
    \normalexpandarg
	\exploregroups
	\StrCount{ABCDEFGHIJKLMNOPQRSTUVWXYZ}{#1}[\uppercount]
	\ifnumgreater{\uppercount}{0}{#2}{#3}
}

%smart index
\DeclareDocumentCommand{\i}{u{_} m}{
	\ifupper{#1}%
	{% just a single uppercase character, i.e. a matrix
		  %make sure the index is the right length
		\StrCount{#2}{,}[\indcount]
		\ifnumgreater{\indcount}{0}
		{ % Got multiple indexes so all good
		 	\ind{#1}{#2}
		}
		{ % Only 1 index so grab the column
		 	\ind{#1}{{:,#2}}
		}
	}%
	{% Not just a single upper case character
		\ind{#1}{#2}
	}
}

\DeclareDocumentCommand{\n}{u{_} m}{
	\seqind{#1}{#2}
}

\DeclareDocumentCommand{\d}{u{_} m}{
	\disamb{#1}{#2}
}

% Index of a vector
\DeclareDocumentCommand{\iv}{u{_} m}{\i{\v #1}_{#2}}
\DeclareDocumentCommand{\dv}{u{_} m}{\d{\v #1}_{#2}}

%exp
\let\oldexp\exp
\renewcommand{\exp}[1]{\oldexp \left( #1 \right)}

\newcommand{\softmax}{\mathrm{smax}}