\documentclass{standalone}

\input{../../preamble-tikz.tex}

\begin{document}

\begin{tikzpicture}[]

\node(L0)[layer]{Input: 784 element vector, being a flattened $28 \times 28$ image};

\foreach \i/\y[count=\j from 0] in {1/512, 2/128, 3/64, 4/2, 5/128, 6/512, 7/784}{
	\node(L\i)[layer, above= of L\j] {
		\ifthenelse{\j=6}{Output 784 element vector approximating input}%
		{Hidden layer with $\y$ neurons}%
	};
%
	\draw[->] (L\j) edge  node[labe]{
		\ifthenelse{\j = 0}{$z_1=x$}{$z_\i=\varphi(W_\i\,z_\j+b_\i)$}
	}(L\i);	
}
\node(lbl code)[labe, left=0 of L4]{Code layer:};

%
\end{tikzpicture}

\end{document}